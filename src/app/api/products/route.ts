import { NextRequest,NextResponse } from 'next/server';import { supabaseServer } from '@/lib/supabaseClient';
export async function GET(){const sb=supabaseServer();const {data,error}=await sb.from('menu_items').select('*').order('id',{ascending:true}); if(error) return NextResponse.json({error:error.message},{status:400}); return NextResponse.json({products:data})}
export async function POST(req:NextRequest){const b=await req.json(); const payload={name:b.name,description:b.description??null,price_cents:Number(b.price_cents),category_id:b.category_id??null,is_available:b.is_available??true,image_url:b.image_url??null}; if(!payload.name||!payload.price_cents) return NextResponse.json({error:'Name and price_cents required'},{status:400}); const sb=supabaseServer(); const {data,error}=await sb.from('menu_items').insert(payload).select().single(); if(error) return NextResponse.json({error:error.message},{status:400}); return NextResponse.json({product:data})}
